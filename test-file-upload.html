<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–‡ä»¶ä¸Šä¼ æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            max-width: 800px;
            margin: 2rem auto;
            padding: 1rem;
            line-height: 1.6;
        }
        .test-section {
            border: 2px dashed #ccc;
            padding: 2rem;
            margin: 1rem 0;
            border-radius: 8px;
        }
        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
        }
        .btn:hover {
            background: #0056b3;
        }
        #fileInput {
            display: none;
        }
        .log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 1rem;
            margin: 1rem 0;
            font-family: monospace;
            font-size: 14px;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <h1>æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æµ‹è¯•</h1>
    
    <div class="test-section">
        <h2>æµ‹è¯•1: åŸºç¡€æ–‡ä»¶é€‰æ‹©</h2>
        <input type="file" id="fileInput" accept=".pdf,.doc,.docx,.txt">
        <button class="btn" id="selectFileBtn">é€‰æ‹©æ–‡ä»¶</button>
        <p>ç‚¹å‡»æŒ‰é’®åº”è¯¥å¼¹å‡ºæ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†</p>
    </div>
    
    <div class="test-section">
        <h2>æµ‹è¯•2: è°ƒè¯•ä¿¡æ¯</h2>
        <button class="btn" onclick="runDebugTest()">è¿è¡Œè°ƒè¯•æµ‹è¯•</button>
        <button class="btn" onclick="clearLog()">æ¸…é™¤æ—¥å¿—</button>
    </div>
    
    <div class="log" id="logOutput">
        <div>ç­‰å¾…æµ‹è¯•ç»“æœ...</div>
    </div>
    
    <script>
        // æ—¥å¿—è¾“å‡ºå‡½æ•°
        function log(message) {
            const logOutput = document.getElementById('logOutput');
            const timestamp = new Date().toLocaleTimeString();
            logOutput.innerHTML += `<div>[${timestamp}] ${message}</div>`;
            logOutput.scrollTop = logOutput.scrollHeight;
        }
        
        function clearLog() {
            document.getElementById('logOutput').innerHTML = '';
        }
        
        // æµ‹è¯•æ–‡ä»¶é€‰æ‹©åŠŸèƒ½
        function setupFileUploadTest() {
            const fileInput = document.getElementById('fileInput');
            const selectBtn = document.getElementById('selectFileBtn');
            
            log('å¼€å§‹è®¾ç½®æ–‡ä»¶ä¸Šä¼ æµ‹è¯•...');
            
            if (!fileInput) {
                log('âŒ é”™è¯¯: æœªæ‰¾åˆ°fileInputå…ƒç´ ');
                return;
            }
            
            if (!selectBtn) {
                log('âŒ é”™è¯¯: æœªæ‰¾åˆ°é€‰æ‹©æ–‡ä»¶æŒ‰é’®');
                return;
            }
            
            // ç»‘å®šæ–‡ä»¶é€‰æ‹©å˜åŒ–äº‹ä»¶
            fileInput.addEventListener('change', function(e) {
                log(`âœ… æ–‡ä»¶é€‰æ‹©æˆåŠŸ: ${e.target.files.length} ä¸ªæ–‡ä»¶`);
                Array.from(e.target.files).forEach((file, index) => {
                    log(`   æ–‡ä»¶${index + 1}: ${file.name} (${file.type || 'æœªçŸ¥ç±»å‹'})`);
                });
            });
            
            // ç»‘å®šæŒ‰é’®ç‚¹å‡»äº‹ä»¶
            selectBtn.addEventListener('click', function(e) {
                e.preventDefault();
                log('ğŸ–±ï¸ é€‰æ‹©æ–‡ä»¶æŒ‰é’®è¢«ç‚¹å‡»');
                
                try {
                    fileInput.click();
                    log('âœ… æˆåŠŸè§¦å‘æ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†');
                } catch (error) {
                    log(`âŒ è§¦å‘æ–‡ä»¶é€‰æ‹©å¤±è´¥: ${error.message}`);
                }
            });
            
            log('âœ… æ–‡ä»¶ä¸Šä¼ æµ‹è¯•è®¾ç½®å®Œæˆ');
        }
        
        function runDebugTest() {
            log('=== å¼€å§‹è°ƒè¯•æµ‹è¯• ===');
            
            const fileInput = document.getElementById('fileInput');
            const selectBtn = document.getElementById('selectFileBtn');
            
            log(`fileInputå…ƒç´ : ${fileInput ? 'âœ… å­˜åœ¨' : 'âŒ ä¸å­˜åœ¨'}`);
            log(`é€‰æ‹©æ–‡ä»¶æŒ‰é’®: ${selectBtn ? 'âœ… å­˜åœ¨' : 'âŒ ä¸å­˜åœ¨'}`);
            
            if (fileInput) {
                log(`fileInput.id: ${fileInput.id}`);
                log(`fileInput.accept: ${fileInput.accept}`);
                log(`fileInput.hidden: ${fileInput.hidden}`);
                log(`fileInput.disabled: ${fileInput.disabled}`);
            }
            
            if (selectBtn) {
                log(`æŒ‰é’®.id: ${selectBtn.id}`);
                log(`æŒ‰é’®.className: ${selectBtn.className}`);
                log(`æŒ‰é’®.textContent: ${selectBtn.textContent}`);
            }
            
            // æµ‹è¯•æµè§ˆå™¨å…¼å®¹æ€§
            log(`æµè§ˆå™¨ä¿¡æ¯: ${navigator.userAgent}`);
            log(`æ˜¯å¦æ”¯æŒFile API: ${window.File ? 'âœ…' : 'âŒ'}`);
            log(`æ˜¯å¦æ”¯æŒFileList: ${window.FileList ? 'âœ…' : 'âŒ'}`);
            log(`æ˜¯å¦æ”¯æŒFileReader: ${window.FileReader ? 'âœ…' : 'âŒ'}`);
            
            log('=== è°ƒè¯•æµ‹è¯•å®Œæˆ ===');
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            log('ğŸ“„ é¡µé¢åŠ è½½å®Œæˆï¼Œå¼€å§‹åˆå§‹åŒ–æµ‹è¯•');
            setupFileUploadTest();
        });
    </script>
</body>
</html>
